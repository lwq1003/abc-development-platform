<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tech.abc.edoc.edoc.mapper.FolderPermissionMapper">
    <select id="getPermissionByUserGroup" resultType="java.lang.String">
        select distinct t1.permission_code from ed_folder_permission t1
        left join ed_folder t2 on t1.folder_id=t2.id
        left join sys_user_group t3 on t1.object_id=t3.id
        left join sys_group_user t4 on t3.id=t4.group_id
        left join sys_user t5 on t4.user_id=t5.id
        where t1.object_type='USER_GROUP'
        and t5.id=#{userId}
        and t2.id in
        <foreach collection="folderIdList" index="index" item="item" open="("
                 separator="," close=")">
            #{item}
        </foreach>
    </select>


    <select id="getPermissionByOrganization" resultType="java.lang.String">
        select distinct t1.permission_code from ed_folder_permission t1
        left join ed_folder t2 on t1.folder_id=t2.id
        left join sys_organization t3 on t1.object_id=t3.id
        where t1.object_type='ORGANIZATION'
        and t2.id in
        <foreach collection="folderIdList" index="index" item="item" open="("
                 separator="," close=")">
            #{item}
        </foreach>
        and t3.id in
        <foreach collection="organizationIdList" index="index" item="item" open="("
                 separator="," close=")">
            #{item}
        </foreach>
    </select>
</mapper>
