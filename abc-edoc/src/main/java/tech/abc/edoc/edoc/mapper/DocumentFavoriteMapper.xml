<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tech.abc.edoc.edoc.mapper.DocumentFavoriteMapper">
    <select id="getFavoriteList" resultType="tech.abc.edoc.edoc.entity.DocumentFavorite">
        select * from (
                          select t1.id,t1.object_type,t1.object_id,t2.name,'' as size,'文件夹' as type from ed_document_favorite t1
                              left join ed_folder t2 on t1.object_id=t2.id
                          where t1.object_type='FOLDER'
                            and t1.delete_flag='NO'
                            and t1.user_id=#{userId}
                            and t2.name like CONCAT('%', #{name}, '%')
                          union
                          select t1.id,t1.object_type,t1.object_id,t2.name,t2.size,t2.type from ed_document_favorite t1
                              left join ed_document t2 on t1.object_id=t2.id
                          where t1.object_type='DOCUMENT'
                            and t1.delete_flag='NO'
                            and t1.user_id=#{userId}
                            and t2.name like CONCAT('%', #{name}, '%')
                      ) t
        order by object_type desc,name
    </select>
</mapper>
